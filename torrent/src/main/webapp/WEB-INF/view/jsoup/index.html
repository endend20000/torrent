<!DOCTYPE html>
<html style="height: 100%">
<head>
    <title>资源搜索</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">
    <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" integrity="sha384-zF4BRsG/fLiTGfR9QL82DrilZxrwgY/+du4p/c7J72zZj+FLYq4zY00RylP9ZjiT" crossorigin="anonymous">
    <style type="text/css">
        .table > thead > tr > th{
            background-color:#99cdff;
        }
         tbody > tr:nth-of-type(odd) {
            background-color: #f9f9f9;
        }
         tbody > tr:nth-of-type(odd):hover {
             background-color: #E8E8E8;
         }
         tbody > tr:nth-of-type(even) {
             background-color: #d9edf7;
         }
         tbody > tr:nth-of-type(even):hover {
             background-color:#C4E3F3 ;
         }
    </style>
</head>
<body style="height: 100%;background:center 100%;background-image: url('/torrent/assets/img/background.jpg') ;background-repeat :no-repeat;">
<div style="height: 100%;width:100%;overflow-y:scroll;">
    <div class="header" style="white-space:nowrap;">
        <nav class="navbar navbar-default">
            <div class="container-fluid" style="height: 100% ;min-width: 1000px">
                <div class="navbar-header">
                    <span class="navbar-brand">大家在搜：</span>
                </div>

                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="#">铁甲城的卡巴里内</a></li>
                        <li><a href="#">反叛的鲁路修</a></li>
                        <li><a href="#">高达</a></li>
                        <li><a href="#">舰队collection</a></li>
                    </ul>
                    <form class="navbar-form navbar-left" role="search" id="form-search">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="什么都能搜" v-model.trim="searchContent">
                        </div>
                        <button type="submit" class="btn btn-default" v-on:click.prevent="search">搜索</button>
                    </form>
<!--                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="#">注册</a></li>
                        <li><a href="#">登录</a></li>
                    </ul>-->
                </div>
            </div>
        </nav>
    </div>
    <div class="container">
        <table class="table table-hover" style="min-width:800px;max-width:1500px;">
            <!--class="table table-striped table-hover style="filter: Alpha(Opacity=50, Style=3 ); ""background-color:#79f2ff;filter: Alpha(opacity=50) -->
            <thead>
            <tr >
                <th>资源描述</th>
                <th style="width:120px">日期</th>
                <th style="width:100px">下载</th>
            </tr>
            </thead>
            <tbody id="tbody-items">

            <template v-for="item in items">
                <tr>
                    <td>{{ item.text}}</td>
                    <td>{{ item.createdTime}}</td>
                    <td is="item" :item=item></td>
                </tr>
            </template>
            </tbody>
        </table>
    </div>
</div>
<script src="https://code.jquery.com/jquery.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://unpkg.com/vue"></script>
<script>
    var itemData={items:[]};
    var searchVue = new Vue({
        el: '#form-search',
        data: {searchContent:''},
        methods: {
            search:function () {
                $.ajax({
                    url: "/torrent/jsoup/data.json",    //请求的url地址
                    dataType: "json",   //返回格式为json
                    data: { "keyword":this.searchContent ,page:1,rows:30},    //参数值
                    type: "get",
                    success: function(data) {
                       console.log(data);
                       itemData.items=data.rows;
                    },
                    error:function(data) {
                        console.log(data);
                        alert(data);
                    }
                });
            }
        }
    })

    var datalist = new Vue({
        el: '#tbody-items',
        data: itemData,
        components: {
            item: {
            	props:['item'],
            	template: "<td><a href='#' v-on:click.prevent='download'>磁力链</a></td>",
                methods: {
                	download:function(){
        	    		$.ajax({
        				 	url: "/torrent/jsoup/torrent.json",    //请求的url地址
        				 	dataType: "json",   //返回格式为json
        				 	data: {url:this.item.url,type:this.item.type},    //参数值
        				 	type: "get",  
        	   			 	success: function(data) {
        	   			 		if(data.status=='1'){
        	   			 			if(type==0){
        	   			 				window.location.href=req.dataset
        	   			 			}else{
        	   			 			    window.open(req.dataset); 
        	   			 			}
        	   			 		}else{
        	   			 			alert("异常"+req.msg);
        	   			 		}                			 		
        					},
        					error:function(data) {
        						console.log(data);
        						alert("请求出错");
        						//$.messager.alert("警告", "请求出错","error"); 
        					}
        			});
        		}}
            }
          }

    })
    
/*     var download2 = function(url,type){
    	$.ajax({
			 	url: "${path}/jsoup/torrent.json",    //请求的url地址
			 	dataType: "json",   //返回格式为json
			 	async: true, //请求是否异步，默认为异步，这也是ajax重要特性
			 	data: { "url": url,"type":type },    //参数值
			 	type: "get",  
   			 	success: function(req) {
   			 		if(req.status=='1'){
   			 			if(type==0){
   			 				//alert(req.dataset);
   			 				window.location.href=req.dataset
   			 			}else{
   			 			    window.open(req.dataset); 
   			 			}
   			 		   
   			 			//alert(req.dataset);
   			 		}else{
   			 			$.messager.alert("异常", req.msg,"error"); 
   			 		}                			 		
				},
				error:function(req) {
					console.log(req);
					$.messager.alert("警告", "请求出错","error"); 
				}
		});
	} */
</script>
</body>
</html>